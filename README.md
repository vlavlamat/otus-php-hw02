# 🐧 Домашнее задание №2 — Bash-скрипты

## ✨ Цель

* Освоить написание Bash-скриптов для автоматизации типовых задач.
* Научиться работать с аргументами, условиями, регулярными выражениями.
* Применить утилиты Linux (`awk`, `sort`, `uniq`, `head`) для обработки табличных данных.
* Повысить уверенность в работе с shell-окружением, Docker и Makefile.

---

## 🪩 Задания

### 1. 💟 Калькулятор суммы

Создайте Bash-скрипт `sum.sh`, который принимает **два аргумента** (вещественные или целые числа, в том числе отрицательные) и выводит их **сумму**.

> 💡 Скрипт должен проверять, что оба аргумента являются числами. При неверных входных данных — вывести сообщение об ошибке.

Вы можете воспользоваться двумя способами запуска:

#### ✅ Вариант 1 — Через `Makefile` с параметрами:

```bash
make up                   # Запуск контейнера
make sum a=5 b=23         # Выполнить скрипт с аргументами
```

#### ✅ Вариант 2 — Через интерактивный bash внутри контейнера:

```bash
make run                  # Войти в режим bash
sum 1.5 -7                # Запуск скрипта ручной командой
```

---

### 🌆 Топ-3 популярных города среди пользователей

Файл с данными находится по пути: `data/users.txt`, и содержит таблицу следующего вида:

```
id user city phone
1 test Moscow 1234123
2 test2 Saint-P 1232121
3 test3 Tver 4352124
4 test4 Milan 7990923
5 test5 Moscow 908213
```

Скрипт анализирует этот файл и выводит **3 самых часто встречающихся города**.

---

#### 🔧 Вариант 1: запуск через отдельные команды

```bash
make up           # Запускает контейнер в фоне
make top-cities   # Показывает 3 самых популярных города
```

#### ⚡ Вариант 2: запуск контейнера и сразу переход в интерактивный режим

```bash
make run          # Запускает контейнер и открывает Bash
top-cities        # Ввести внутри контейнера: запускает анализ файла
```
> 📌 Скрипт `top_cities.sh` уже добавлен в контейнер и доступен как команда `top-cities`, благодаря символьной ссылке `/usr/local/bin/top-cities`.

---

## 🚀 Запуск с Docker и Makefile

Все команды обернуты в `Makefile` для удобства и автоматизации.

### 🔧 Основные команды:

```bash
make up             # Сборка и запуск контейнера
make down           # Остановка и удаление контейнера
make rebuild        # Пересобрать контейнер с нуля
make run            # Запуск и вход в интерактивную сессию bash
make shell          # Просто войти в контейнер
make install        # Установить зависимости (bc и др.)
make sum a=5 b=6    # Вызов скрипта суммы
make top-cities     # Вызов скрипта статистики по городам
```

---

### 🤔 Почему Docker + Makefile?

> Такой подход позволяет:
>
> * закрыть всю логику в одном Make-файле;
> * упростить вызов скриптов и управление окружением;
> * соблюдать DevOps-практики и обеспечить воспроизводимость.

---

## 📁 Структура проекта

```
hw02-bash/
├── docker/
│   └── bash.Dockerfile
├── scripts/
│   ├── sum.sh             # скрипт-калькулятор
│   └── top_cities.sh      # анализ городов
├── data/
│   └── users.txt          # таблица пользователей
├── docker-compose.yml     # конфиг Docker
├── Makefile               # скрипты для управления
└── README.md              # документация
```

---

## 📃 Полезные ссылки

* [Примеры bash-скриптов](https://github.com/ruanyf/simple-bash-scripts)
* [Обработка текста в Bash (Habr)](https://habr.com/ru/articles/336596/)
* [awk, uniq, sort в задачах](https://habr.com/ru/companies/ruvds/articles/325522/)
* [Работа с rsync](https://selectel.ru/blog/rsync-guide/)
